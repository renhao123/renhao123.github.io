webpackJsonp([29],{2243:function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=a(0),s=a.n(l),o=a(133),c=a(393),u=a(2244),d=a(45),m=a.n(d),p=a(132),f=a(1147),h=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),b=c.k.Item,g=c.i.RangePicker,y={labelCol:{span:10},wrapperCol:{span:14,style:{paddingLeft:"10px"}}},w=[{label:"\u5931\u8054\u9884\u8b66",value:"alarmMiss"},{label:"\u591c\u5f52\u9884\u8b66",value:"alarmBack"},{label:"\u9003\u8bfe\u9884\u8b66",value:"alarmCourse"}],v=function(e){return e&&e<m()().endOf("day")},k="YYYY-MM-DD",O={width:258,height:58,borderRadius:4,border:"1px dashed #d9d9d9",cursor:"pointer",marginTop:-10,lineHeight:"20px",textAlign:"center"},E=function(e){function t(){var e,a,i,l;n(this,t);for(var s=arguments.length,o=Array(s),u=0;u<s;u++)o[u]=arguments[u];return a=i=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),i.state={visible:!1,selectedStudent:void 0,editId:void 0,editInfo:void 0},i.chooseStudent=function(e){i.setState({selectedStudent:e,visible:!1}),i.props.form.setFieldsValue({studentNo:e.studentNo})},i.saveAction=function(){i.props.form.validateFields(function(e,t){if(!e){var a=t.studentNo,n=t.remark,r=t.warnModule,l=t.rangePicker,s=r.indexOf("alarmMiss")>=0?1:0,o=r.indexOf("alarmNetwork")>=0?1:0,u=r.indexOf("alarmFail")>=0?1:0,d=r.indexOf("alarmConsume")>=0?1:0,m=r.indexOf("alarmBack")>=0?1:0,p=r.indexOf("alarmCourse")>=0?1:0,h={studentNo:a,alarmMiss:s,alarmNetwork:o,alarmFail:u,alarmConsume:d,alarmBack:m,alarmCourse:p,remark:n,startDate:l[0].format(k),endDate:l[1].format(k)};i.state.editInfo?(h.id=i.state.editInfo.id,Object(f.b)("/bigdata/alarmWhitelist/update",h).then(function(e){e.success?c.J.success("\u4fee\u6539\u6210\u529f\uff01",1,function(){i.props.history.push("/mainframe/systemsetup/earlywarningwhitelist")}):c.J.warn(e.obj)})):Object(f.b)("/bigdata/alarmWhitelist/save",h).then(function(e){e.success?c.J.success("\u4fdd\u5b58\u6210\u529f\uff01",1,function(){i.props.history.push("/mainframe/systemsetup/earlywarningwhitelist")}):c.J.warn(e.obj)})}})},l=a,r(i,l)}return i(t,e),h(t,[{key:"componentWillMount",value:function(){var e=this,t=Object(p.d)();if(t.id){var a={id:t.id};Object(f.b)("/bigdata/alarmWhitelist/findById",a).then(function(a){a.success?e.setState({editId:t.id},function(){var t=a.obj,n=[1===t.alarmMiss?"alarmMiss":null,1===t.alarmNetwork?"alarmNetwork":null,1===t.alarmFail?"alarmFail":null,1===t.alarmConsume?"alarmConsume":null,1===t.alarmBack?"alarmBack":null,1===t.alarmCourse?"alarmCourse":null].filter(function(e){return null!==e}),r=Object.assign({},{warnModule:n},t)||{};e.setState({editInfo:r,selectedStudent:r})}):c.J.warn(a.obj)})}}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,a=this.state.editInfo,n=this.state.selectedStudent;return s.a.createElement(s.a.Fragment,null,s.a.createElement(c.e,{title:s.a.createElement("div",{className:"common-title"},this.state.editId?"\u7f16\u8f91\u4e2a\u4eba\u767d\u540d\u5355\u914d\u7f6e":"\u65b0\u589e\u4e2a\u4eba\u767d\u540d\u5355\u914d\u7f6e")},s.a.createElement(b,Object.assign({},y,{style:{paddingTop:10},label:"\u9009\u62e9\u5b66\u751f"}),t("studentNo",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5b66\u751f\uff01"}],initialValue:a&&a.studentNo})(s.a.createElement(c.x,{type:"flex",align:"middle",justify:"center",style:O,onClick:function(){return e.setState({visible:!0})}},n?s.a.createElement("div",null,n.name||n.studentName," ",s.a.createElement("br",null),n.studentNo,"\uff0c",n.collegeName):s.a.createElement("div",null,s.a.createElement(c.l,{type:"plus"})," \u6dfb\u52a0\u5b66\u751f")))),s.a.createElement(b,Object.assign({},y,{label:"\u9009\u62e9\u4e0d\u9884\u8b66\u65f6\u95f4"}),t("rangePicker",{rules:[{type:"array",required:!0,message:"\u8bf7\u9009\u62e9\u4e0d\u9884\u8b66\u65f6\u95f4\uff01"}],initialValue:a&&[m()(a.startDate,k),m()(a.endDate,k)]})(s.a.createElement(g,{style:{width:398},disabledDate:v}))),s.a.createElement(b,Object.assign({},y,{label:"\u5173\u8054\u6a21\u5757"}),t("warnModule",{rules:[{type:"array",required:!0,message:"\u8bf7\u9009\u62e9\u5173\u8054\u6a21\u5757\uff01"}],initialValue:a&&a.warnModule})(s.a.createElement(c.g.Group,null,s.a.createElement(c.x,null,w.map(function(e){return s.a.createElement(c.h,{span:8,style:{paddingTop:10},key:e.value},s.a.createElement(c.g,{value:e.value},e.label))}))))),s.a.createElement(b,Object.assign({},y,{label:"\u5907\u6ce8"}),t("remark",{initialValue:a&&a.remark})(s.a.createElement(c.m.TextArea,{style:{width:398,height:138,resize:"none"},maxLength:"50"}))),s.a.createElement(c.x,null,s.a.createElement(c.h,y.labelCol),s.a.createElement(c.h,y.wrapperCol,s.a.createElement(c.d,{size:"large",type:"primary",style:{marginRight:20},onClick:this.saveAction},"\u4fdd \u5b58"),s.a.createElement(c.d,{size:"large",onClick:function(){e.props.history.push("/mainframe/systemsetup/earlywarningwhitelist")}},"\u8fd4 \u56de")))),this.state.visible?s.a.createElement(u.a,{title:"\u9009\u62e9\u5b66\u751f",visible:this.state.visible,selectedStudent:this.state.selectedStudent,onCancel:function(){return e.setState({visible:!1})},onOk:this.chooseStudent}):null)}}]),t}(l.Component),S=c.k.create()(E);t.default=Object(o.withRouter)(S)},2244:function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=a(0),s=a.n(l),o=a(393),c=a(1189),u=a(1147),d=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),m=[{title:"\u5e8f\u53f7",dataIndex:"index",width:80,align:"center"},{title:"\u5b66\u53f7",dataIndex:"studentId",width:200,align:"center"},{title:"\u59d3\u540d",dataIndex:"studentName",width:250,align:"center"},{title:"\u9662\u7cfb",dataIndex:"collegeName",align:"center"}],p=function(e){function t(){var e,a,i,l;n(this,t);for(var s=arguments.length,c=Array(s),d=0;d<s;d++)c[d]=arguments[d];return a=i=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),i.state={pageNum:1,pageSize:10,total:0,studentLists:[],studentNo:void 0,name:void 0,selectedRowKeys:[],selectedRows:[]},i.getData=function(){var e=i.state,t=e.studentNo,a=e.name,n=e.pageNum,r=e.pageSize,l={studentNo:t,name:a,pageInfo:{pageNum:n,pageSize:r}};Object(u.b)("/bigdata/student/getStudentInfoPager",l).then(function(e){e.success?i.setState({total:e.obj.total,studentLists:e.obj.list||[]}):o.J.warn(e.obj)})},i.onOk=function(){i.state.selectedRows[0]?i.props.onOk(i.state.selectedRows[0]):o.J.warn("\u8bf7\u9009\u62e9\u5b66\u751f\uff01")},i.changePage=function(e){i.setState({pageNum:e.current,pageSize:e.pageSize},function(){i.getData()})},i.rowClick=function(e){var t={studentNo:e.studentNo};Object(u.b)("/bigdata/alarmWhitelist/checkName",t).then(function(t){t.success?i.setState({selectedRowKeys:[e.key],selectedRows:[e]}):o.J.warn(t.obj)})},i.onSelectChange=function(e,t){i.setState({selectedRowKeys:e,selectedRows:t})},l=a,r(i,l)}return i(t,e),d(t,[{key:"componentWillMount",value:function(){this.props.selectedStudent&&this.setState({selectedRowKeys:[this.props.selectedStudent.studentNo],selectedRows:[this.props.selectedStudent]}),this.getData()}},{key:"render",value:function(){var e=this,t=this.state.studentLists||[];t.forEach(function(e,a){t[a].key=e.studentNo,t[a].index=a+1});var a=this.state.selectedRowKeys,n={selectedRowKeys:a,type:"radio",columnWidth:"40px",onChange:this.onSelectChange};return s.a.createElement(c.a,{title:this.props.title,visible:this.props.visible,centered:!0,onCancel:this.props.onCancel,onOk:this.onOk,width:1004},s.a.createElement(o.x,{style:{marginBottom:24}},s.a.createElement(o.h,{span:5},"\u5b66\u53f7\uff1a",s.a.createElement(o.m,{style:{width:132},placeholder:"\u8bf7\u8f93\u5165\u5b66\u53f7",value:this.state.studentNo,onChange:function(t){return e.setState({studentNo:t.target.value})}})),s.a.createElement(o.h,{span:7},"\u59d3\u540d\uff1a",s.a.createElement(o.m,{style:{width:226},placeholder:"\u8bf7\u8f93\u5165\u5b66\u751f\u59d3\u540d",value:this.state.name,onChange:function(t){return e.setState({name:t.target.value})}})),s.a.createElement(o.h,{span:12},s.a.createElement(o.d,{icon:"search",type:"primary",onClick:this.getData},"\u641c \u7d22"))),s.a.createElement(o.B,{dataSource:t,bordered:!0,rowSelection:n,columns:m,pagination:{size:"small",current:this.state.pageNum,total:this.state.total,showQuickJumper:!0,showTotal:function(e){return"\u5171 "+e+" \u6761\u6570\u636e"}},size:"middle",onChange:this.changePage,onRow:function(t,a){return{onClick:function(){return e.rowClick(t,a)}}}}))}}]),t}(l.Component);t.a=p}});
//# sourceMappingURL=29.2b5c67a4.chunk.js.map