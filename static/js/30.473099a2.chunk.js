webpackJsonp([30],{2245:function(e,t,a){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function s(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=a(0),o=a.n(l),c=a(133),u=a(393),d=a(2246),g=a(45),p=a.n(g),f=a(132),m=a(1147),y=function(){function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}(),h=u.k.Item,b=u.i.RangePicker,v={labelCol:{span:10},wrapperCol:{span:14,style:{paddingLeft:"10px"}}},w=function(e){return e&&e<p()().endOf("day")},E="YYYY-MM-DD",D={width:258,height:58,borderRadius:4,border:"1px dashed #d9d9d9",cursor:"pointer",marginTop:-10,lineHeight:"20px",textAlign:"center"},C=function(e){function t(){var e,a,s,l;n(this,t);for(var o=arguments.length,c=Array(o),d=0;d<o;d++)c[d]=arguments[d];return a=s=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),s.state={visible:!1,confirmVisible:!1,selectedTarget:void 0,editId:void 0,editInfo:void 0,rangePickerValue:[],dateArr:[]},s.chooseStudent=function(e){s.setState({selectedTarget:e,visible:!1});var t=e.strategyTargetCollegeName?e.strategyTargetCollegeName.split("\u3001"):[];s.props.form.setFieldsValue({strategyId:e.id,strategyTargetCollege:t})},s.saveAction=function(){s.props.form.validateFields(function(e,t){if(!e){var a=t.strategyId,r=t.remark,n=!0;if(a||s.state.editInfo||(s.props.form.setFields({strategyId:{errors:[new Error("\u8bf7\u9009\u62e9\u5173\u8054\u7684\u9884\u8b66\u7b56\u7565\uff01")]}}),n=!1),0===s.state.dateArr.length&&(n=!1,u.J.error("\u8bf7\u9009\u62e9\u4e0d\u9884\u8b66\u65f6\u95f4")),!n)return;var i=s.state.dateArr.map(function(e){return e.startDate+"~"+e.endDate}).join(",");if(s.state.editInfo){var l={remark:r,strategyDate:i};l.id=s.state.editInfo.id,Object(m.b)("/bigdata/alarmHolidayWhitelist/update",l).then(function(e){e.success?u.J.success("\u4fee\u6539\u6210\u529f\uff01",1,function(){s.props.history.push("/mainframe/systemsetup/earlywarningwhitelist")}):u.J.warn(e.obj)})}else{var o={strategyId:a,strategyTarget:s.state.selectedTarget.strategyTarget,remark:r,strategyDate:i};Object(m.b)("/bigdata/alarmHolidayWhitelist/save",o).then(function(e){e.success?u.J.success("\u4fdd\u5b58\u6210\u529f\uff01",1,function(){s.props.history.push("/mainframe/systemsetup/earlywarningwhitelist")}):u.J.warn(e.obj)})}}})},s.addStrategyDate=function(){var e=s.state.rangePickerValue;if(e&&e.length>0){var t=s.state.dateArr,a={startDate:e[0].format(E),endDate:e[1].format(E)},n=!1;if(t.forEach(function(e){n=!(p()(e.startDate)>p()(a.startDate)&&p()(e.startDate)>p()(a.endDate)||p()(e.endDate)<p()(a.startDate)&&p()(e.endDate)<p()(a.endDate))}),n)return void u.J.error("\u6240\u9009\u65e5\u671f\u91cd\u590d\uff01");t=[].concat(r(t),[a]),s.setState({dateArr:t,rangePickerValue:[]}),s.props.form.setFieldsValue({strategyDate:t})}else u.J.error("\u8bf7\u9009\u62e9\u65e5\u671f\u8303\u56f4\uff01")},s.changeRangePicker=function(e){s.setState({rangePickerValue:e})},s.deletestrategyDate=function(e,t){var a=JSON.parse(JSON.stringify(s.state.dateArr)),r=a.filter(function(t){return!(t.startDate===e.startDate&&t.endDate===e.endDate)});s.setState({dateArr:r}),s.props.form.setFieldsValue({strategyDate:r})},s.showConfirm=function(){s.setState({confirmVisible:!0})},s.setModalClose=function(){s.setState({confirmVisible:!1})},l=a,i(s,l)}return s(t,e),y(t,[{key:"componentWillMount",value:function(){var e=this,t=Object(f.d)();if(t.id){var a={id:t.id};Object(m.b)("/bigdata/alarmHolidayWhitelist/findById",a).then(function(a){a.success?e.setState({editId:t.id},function(){var t=Object.assign({},a.obj)||{},r={id:t.strategyId,strategyName:t.strategyName,strategyTarget:t.strategyTarget,strategyTargetCollege:t.strategyTargetCollege,strategyDate:t.strategyDate},n=[];""!==a.obj.strategyDate&&(n=a.obj.strategyDate.split(",").map(function(e){return{startDate:e.split("~")[0],endDate:e.split("~")[1]}}));var i=t.strategyTargetCollege?r.strategyTargetCollege.split("\u3001"):[];e.setState({editInfo:t,selectedTarget:r,dateArr:n}),e.props.form.setFieldsValue({strategyDate:n,strategyTargetCollege:i})}):u.J.warn(a.obj)})}}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,a=this.state.editInfo,r=this.state.selectedTarget,n=this.props.form.getFieldValue("strategyTargetCollege")||[],i=this.state.dateArr;return o.a.createElement(o.a.Fragment,null,o.a.createElement(u.e,{title:o.a.createElement("div",{className:"common-title"},this.state.editId?"\u7f16\u8f91\u8282\u5047\u65e5\u767d\u540d\u5355\u914d\u7f6e":"\u65b0\u589e\u8282\u5047\u65e5\u767d\u540d\u5355\u914d\u7f6e")},o.a.createElement(h,Object.assign({},v,{style:{paddingTop:10},label:"\u9009\u62e9\u5173\u8054\u7684\u9884\u8b66\u7b56\u7565"}),t("strategyId",{rules:[{message:"\u8bf7\u9009\u62e9\u5173\u8054\u7684\u9884\u8b66\u7b56\u7565\uff01"}],initialValue:a&&a.strategyId})(o.a.createElement(u.x,{type:"flex",align:"middle",justify:"center",style:D,onClick:function(){e.state.editInfo||e.setState({visible:!0})}},r?o.a.createElement("div",null,r.strategyName):o.a.createElement("div",null,o.a.createElement(u.l,{type:"plus"})," \u9009\u62e9\u5173\u8054\u7684\u9884\u8b66\u7b56\u7565")))),o.a.createElement(h,Object.assign({},v,{label:"\u4e0d\u9884\u8b66\u5b66\u9662"}),t("strategyTargetCollege",{rules:[{type:"array"}]})(o.a.createElement("div",null,n.map(function(e,t){return o.a.createElement(u.D,{style:{height:28,lineHeight:"28px",color:"#4a4a4a"},key:t},e)})))),o.a.createElement(h,Object.assign({},v,{label:"\u9009\u62e9\u4e0d\u9884\u8b66\u65f6\u95f4"}),t("strategyDate",{rules:[{type:"array",message:"\u8bf7\u9009\u62e9\u4e0d\u9884\u8b66\u65f6\u95f4\uff01"}]})(o.a.createElement(o.a.Fragment,null,o.a.createElement("div",null,o.a.createElement(b,{style:{width:398},disabledDate:w,value:this.state.rangePickerValue,onChange:this.changeRangePicker}),o.a.createElement(u.l,{type:"plus-circle-o",style:{marginLeft:10,cursor:"pointer"},onClick:this.addStrategyDate})),o.a.createElement("div",null,i.map(function(t,a){return o.a.createElement("div",{key:a},o.a.createElement(u.D,{style:{height:28,lineHeight:"28px",color:"#4a4a4a"}},t.startDate+"~"+t.endDate,o.a.createElement(u.l,{type:"close",style:{marginLeft:5,color:"rgba(0, 0, 0, 0.45)"},onClick:function(){return e.deletestrategyDate(t,a)}})))}))))),o.a.createElement(h,Object.assign({},v,{label:"\u5907\u6ce8"}),t("remark",{initialValue:a&&a.remark})(o.a.createElement(u.m.TextArea,{style:{width:398,height:138,resize:"none"},maxLength:"50"}))),o.a.createElement(u.x,null,o.a.createElement(u.h,v.labelCol),o.a.createElement(u.h,v.wrapperCol,o.a.createElement(u.d,{size:"large",type:"primary",style:{marginRight:20},onClick:this.saveAction},"\u4fdd \u5b58"),o.a.createElement(u.d,{size:"large",onClick:this.showConfirm},"\u8fd4 \u56de")))),this.state.visible?o.a.createElement(d.a,{title:"\u9009\u62e9\u9884\u8b66\u7b56\u7565",visible:this.state.visible,selectedTarget:this.state.selectedTarget,onCancel:function(){return e.setState({visible:!1})},onOk:this.chooseStudent}):null,this.state.confirmVisible?o.a.createElement(u.r,{visible:this.state.confirmVisible,onCancel:this.setModalClose,footer:o.a.createElement("div",null,o.a.createElement(u.d,{type:"primary",onClick:function(){e.props.history.push("/mainframe/systemsetup/earlywarningwhitelist")}},"\u786e\u5b9a"),o.a.createElement(u.d,{onClick:this.setModalClose},"\u53d6\u6d88"))},o.a.createElement("div",{style:{padding:"20px"}},o.a.createElement("p",{style:{verticalAlign:"middle"}},o.a.createElement(u.l,{type:"question-circle",style:{color:"#faad14",fontSize:22,marginRight:16,verticalAlign:"middle"}}),o.a.createElement("span",{style:{color:"rgba(0,0,0,.85)",fontWeight:500,fontSize:16,lineHeight:1.4,verticalAlign:"middle"}},"\u786e\u8ba4\u8fd4\u56de\u9884\u8b66\u767d\u540d\u5355\u8bbe\u7f6e\u5417?")),o.a.createElement("p",{style:{marginLeft:38,fontSize:14,color:"rgba(0,0,0,.65)",marginTop:8}},"\u5f53\u524d\u8bbe\u7f6e\u672a\u4fdd\u5b58\uff0c\u8fd4\u56de\u5c06\u4e0d\u4f1a\u4fdd\u5b58\u5df2\u7f16\u8f91\u7684\u5185\u5bb9\u3002"))):null)}}]),t}(l.Component),k=u.k.create()(C);t.default=Object(c.withRouter)(k)},2246:function(e,t,a){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=a(0),l=a.n(s),o=a(393),c=a(1189),u=a(1147),d=function(){function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}(),g=[{title:"\u5e8f\u53f7",dataIndex:"index",width:"8%"},{title:"\u9884\u8b66\u7b56\u7565\u540d\u79f0",dataIndex:"strategyName",width:"20%",render:function(e){return l.a.createElement("span",{title:e},e)}},{title:"\u9884\u8b66\u7b56\u7565\u5bf9\u8c61",dataIndex:"strategyTargetCollegeName",render:function(e){return l.a.createElement("span",{title:e},e)}},{title:"\u9884\u8b66\u7b56\u7565\u65f6\u95f4",dataIndex:"dateTime",width:"20%",render:function(e,t){return t.startDate+"~"+t.endDate}},{title:"\u72b6\u6001",dataIndex:"status",width:"10%",render:function(e,t){var a=void 0;return a="\u751f\u6548"===e?l.a.createElement(o.b,{status:"processing"}):"\u672a\u751f\u6548"===e?l.a.createElement(o.b,{status:"success"}):l.a.createElement(o.b,{status:"default"}),l.a.createElement("span",null,a,e)}}],p=function(e){function t(){var e,a,i,s;r(this,t);for(var l=arguments.length,c=Array(l),d=0;d<l;d++)c[d]=arguments[d];return a=i=n(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),i.state={pageNum:1,pageSize:8,total:0,dataLists:[],strategyName:void 0,selectedRowKeys:[],selectedRows:[],visible:!1},i.getData=function(){var e=i.state,t=e.strategyName,a=e.pageNum,r=e.pageSize,n={pageInfo:{pageNum:a,pageSize:r},strategyName:t};Object(u.b)("/bigdata/alarmStrategy/getPageData",n).then(function(e){e.success?i.setState({total:e.obj.total,dataLists:e.obj.list||[],visible:!0}):o.J.warn(e.obj)})},i.onOk=function(){i.state.selectedRows[0]?i.props.onOk(i.state.selectedRows[0]):o.J.warn("\u8bf7\u9009\u62e9\u9884\u8b66\u7b56\u7565\uff01")},i.changePage=function(e){i.setState({pageNum:e.current,pageSize:e.pageSize},function(){var t=i.state.strategyName,a=Object.assign({},{pageInfo:{pageNum:e.current,pageSize:e.pageSize}},{strategyName:t});i.getData(a)})},i.rowClick=function(e){var t={strategyId:e.id};Object(u.b)("/bigdata/alarmHolidayWhitelist/checkName",t).then(function(t){t.success?t.obj?o.J.error("\u9884\u8b66\u7b56\u7565\u91cd\u590d"):i.setState({selectedRowKeys:[e.key],selectedRows:[e]}):o.J.warn(t.obj)})},i.onSelectChange=function(e,t){i.setState({selectedRowKeys:e,selectedRows:t})},s=a,n(i,s)}return i(t,e),d(t,[{key:"componentWillMount",value:function(){this.props.selectedTarget&&this.setState({selectedRowKeys:[this.props.selectedTarget.id],selectedRows:[this.props.selectedTarget]}),this.getData()}},{key:"render",value:function(){var e=this,t=this.state.dataLists||[];t.forEach(function(e,a){t[a].key=e.id,t[a].index=a+1});var a=this.state.selectedRowKeys,r={selectedRowKeys:a,type:"radio",columnWidth:"40px",onChange:this.onSelectChange};return this.state.visible?l.a.createElement(c.a,{title:this.props.title,visible:!0,onCancel:this.props.onCancel,centered:!0,onOk:this.onOk,width:1004},l.a.createElement(o.x,{style:{marginBottom:24}},l.a.createElement(o.h,{span:9},"\u9884\u8b66\u7b56\u7565\u540d\u79f0\uff1a",l.a.createElement(o.m,{style:{width:246},placeholder:"\u8bf7\u8f93\u5165\u9884\u8b66\u7b56\u7565\u540d\u79f0",value:this.state.strategyName,onChange:function(t){return e.setState({strategyName:t.target.value})}})),l.a.createElement(o.h,{span:12},l.a.createElement(o.d,{icon:"search",type:"primary",onClick:this.getData},"\u641c \u7d22"))),l.a.createElement(o.B,{dataSource:t,bordered:!0,rowSelection:r,columns:g,pagination:{size:"small",current:this.state.pageNum,total:this.state.total,showQuickJumper:!0,showTotal:function(e){return"\u5171 "+e+" \u6761\u6570\u636e"}},size:"middle",onChange:this.changePage,onRow:function(t,a){return{onClick:function(){return e.rowClick(t,a)}}}})):l.a.createElement("div",null)}}]),t}(s.Component);t.a=p}});
//# sourceMappingURL=30.473099a2.chunk.js.map