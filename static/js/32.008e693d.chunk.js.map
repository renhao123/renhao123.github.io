{"version":3,"sources":["../static/js/32.008e693d.chunk.js","pages/AccessManage/Menu/index.js","pages/AccessManage/Menu/AddOrEditRoleModel.js"],"names":["webpackJsonp","2254","module","__webpack_exports__","__webpack_require__","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","defineProperty","__WEBPACK_IMPORTED_MODULE_0_react__","__WEBPACK_IMPORTED_MODULE_0_react___default","n","__WEBPACK_IMPORTED_MODULE_1_antd__","__WEBPACK_IMPORTED_MODULE_2__AddOrEditRoleModel__","__WEBPACK_IMPORTED_MODULE_3__axios__","_createClass","defineProperties","target","props","i","length","descriptor","key","protoProps","staticProps","TreeNode","Tree","iconStyle","fontSize","color","marginLeft","iconActiveStyle","assign","Menu","state","menuLists","selectedKeys","expandedKeys","visible","isEditor","activeData","undefined","getMenuLists","getAction","then","res","success","setState","obj","onSelect","info","node","detail","onDragEnter","onDrop","dragNodeDetail","dragNode","dropNodeDetail","dropKey","eventKey","dragKey","dropPos","pos","split","parentId","subMenus","dropToGap","message","warn","dropPosition","Number","targetSeq","targetParentId","id","seq","params","postAction","error","deleteAction","Modal","confirm","title","name","onOk","data","onCancel","okText","cancelText","saveAction","values","reqUrl","level","toString","this","style","lineHeight","extra","type","onClick","defaultExpandedKeys","draggable","loop","map","item","React","Component","2255","__WEBPACK_IMPORTED_MODULE_2__common_components_MainModal__","FormItem","Form","Item","formItemLayout","labelCol","span","wrapperCol","paddingLeft","AddOrEditRole","sureAction","form","validateFields","err","getFieldDecorator","label","rules","required","initialValue","placeholder","AddOrEditRoleModel"],"mappings":"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","file":"static/js/32.008e693d.chunk.js","sourcesContent":["webpackJsonp([32],{\n\n/***/ 2254:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_react__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_react___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_react__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_antd__ = __webpack_require__(393);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__AddOrEditRoleModel__ = __webpack_require__(2255);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__axios__ = __webpack_require__(1147);\nvar _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if(\"value\"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError(\"Cannot call a class as a function\");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");}return call&&(typeof call===\"object\"||typeof call===\"function\")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!==\"function\"&&superClass!==null){throw new TypeError(\"Super expression must either be null or a function, not \"+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var TreeNode=__WEBPACK_IMPORTED_MODULE_1_antd__[\"H\" /* Tree */].TreeNode;var iconStyle={fontSize:'20px',color:'#aaa',marginLeft:'10px'};var iconActiveStyle=Object.assign({},iconStyle,{color:'rgb(24, 144, 255)'});var Menu=function(_React$Component){_inherits(Menu,_React$Component);function Menu(){var _ref;var _temp,_this,_ret;_classCallCheck(this,Menu);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}return _ret=(_temp=(_this=_possibleConstructorReturn(this,(_ref=Menu.__proto__||Object.getPrototypeOf(Menu)).call.apply(_ref,[this].concat(args))),_this),_this.state={menuLists:[],//菜单列表\nselectedKeys:[],//选中节点\nexpandedKeys:[],//展开节点\nvisible:false,//是否显示新增或修改模态框\nisEditor:false,//是否修改\nactiveData:undefined//选中节点信息\n},_this.getMenuLists=function(){Object(__WEBPACK_IMPORTED_MODULE_3__axios__[\"a\" /* getAction */])('/bigdata/system/menu/list').then(function(res){if(res.success){_this.setState({menuLists:res.obj||[]});}});},_this.onSelect=function(selectedKeys,info){if(selectedKeys.length>0){// console.log(selectedKeys)\n// console.log(info)\n_this.setState({selectedKeys:selectedKeys,activeData:info.node.props.detail});}else{_this.setState({selectedKeys:selectedKeys,activeData:undefined});}},_this.onDragEnter=function(info){// expandedKeys 需要受控时设置\n_this.setState({expandedKeys:info.expandedKeys});},_this.onDrop=function(info){// console.log(info.dragNode)\nvar dragNodeDetail=info.dragNode.props.detail;//拖动节点\nvar dropNodeDetail=info.node.props.detail;//放置节点\nvar dropKey=info.node.props.eventKey;//放置节点id\nvar dragKey=info.dragNode.props.eventKey;//拖动节点id\nvar dropPos=info.node.props.pos.split('-');//如果是父节点不能拖动到别人节点里面\nif(dragNodeDetail&&dragNodeDetail.parentId<=0&&dragNodeDetail.subMenus.length>0&&(dropPos.length>2||!info.dropToGap)){__WEBPACK_IMPORTED_MODULE_1_antd__[\"J\" /* message */].warn('不能移动有子节点的节点！');return;}//限制不能拖动到子节点上\nif(!info.dropToGap&&dropPos.length>2){return;}var dropPosition=info.dropPosition-Number(dropPos[dropPos.length-1]);//参数\nvar targetSeq=void 0,targetParentId=void 0,id=dragKey;if(dropPos.length===2&&!info.dropToGap){targetParentId=dropKey;targetSeq=dropNodeDetail.seq+1;}else if(dropPos.length>2){targetParentId=dropNodeDetail.parentId;targetSeq=dropNodeDetail.seq+dropPosition;}else if(dropPos.length===2&&info.dropToGap){targetParentId=-1;targetSeq=dropNodeDetail.seq+dropPosition;}// console.log(dropPos.length,dropPosition,info.dropToGap,targetSeq,targetParentId,id)\nvar params={id:id,targetParentId:targetParentId,targetSeq:targetSeq};Object(__WEBPACK_IMPORTED_MODULE_3__axios__[\"b\" /* postAction */])('/bigdata/system/menu/move',params,0,1).then(function(res){if(res.success){__WEBPACK_IMPORTED_MODULE_1_antd__[\"J\" /* message */].success('移动成功！');_this.getMenuLists();}else{__WEBPACK_IMPORTED_MODULE_1_antd__[\"J\" /* message */].error(res.obj);}});},_this.deleteAction=function(){if(_this.state.activeData){__WEBPACK_IMPORTED_MODULE_1_antd__[\"r\" /* Modal */].confirm({title:'\\u786E\\u5B9A\\u5220\\u9664'+_this.state.activeData.name+'\\u83DC\\u5355\\u5417?',onOk:function onOk(){var data={id:_this.state.activeData.id};Object(__WEBPACK_IMPORTED_MODULE_3__axios__[\"b\" /* postAction */])('/bigdata/system/menu/delete',data,0,1).then(function(res){if(res.success){__WEBPACK_IMPORTED_MODULE_1_antd__[\"J\" /* message */].success('删除成功！');_this.getMenuLists();}else{__WEBPACK_IMPORTED_MODULE_1_antd__[\"J\" /* message */].error(res.obj);}});},onCancel:function onCancel(){},okText:'确定',cancelText:'取消'});}},_this.saveAction=function(values){var isEditor=_this.state.isEditor;// let { name, seq, url } = values;\nvar name=values.name;// let data = {name, seq, url, sourceCode: 'pc',iconUrl:'test',iconSelectedUrl:'test'};\nvar data={name:name};var reqUrl='/bigdata/system/menu/save';//新增时的角色保存接口\nif(isEditor){//编辑角色时修改请求接口、添加角色id参数\nreqUrl='/bigdata/system/menu/update';data.id=_this.state.activeData.id;data.level=_this.state.activeData.id.toString().length;}// else if(this.state.activeData && this.state.activeData.parentId<=0) {\n// \tdata.parentId = this.state.activeData.id;\n// }\nObject(__WEBPACK_IMPORTED_MODULE_3__axios__[\"b\" /* postAction */])(reqUrl,data,0,1).then(function(res){if(res.success){__WEBPACK_IMPORTED_MODULE_1_antd__[\"J\" /* message */].success('保存成功！');_this.setState({visible:false,isEditor:false},function(){_this.getMenuLists();});}else{__WEBPACK_IMPORTED_MODULE_1_antd__[\"J\" /* message */].error(res.obj);}});},_temp),_possibleConstructorReturn(_this,_ret);}_createClass(Menu,[{key:'componentWillMount',value:function componentWillMount(){this.getMenuLists();}//获取菜单列表\n//选中节点修改\n//拖拽开始\n//拖拽中\n//删除菜单\n//删除和新增确定时保存角色信息\n},{key:'render',value:function render(){var _this2=this;//递归菜单列表\nvar loop=function loop(data){return data.map(function(item){if(item.subMenus&&item.subMenus.length){return __WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(TreeNode,{key:item.id,title:item.name,detail:item},loop(item.subMenus));}return __WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(TreeNode,{key:item.id,title:item.name,detail:item});});};return __WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('div',null,__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_1_antd__[\"e\" /* Card */],{title:__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('span',{style:{color:'#1890FF',lineHeight:'34px'}},'\\u83DC\\u5355'),extra:__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('div',null,__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_1_antd__[\"l\" /* Icon */],{type:'form',style:this.state.activeData?iconActiveStyle:iconStyle,onClick:function onClick(){if(_this2.state.activeData){_this2.setState({visible:true,isEditor:true});}}}))},__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_1_antd__[\"H\" /* Tree */],{onSelect:this.onSelect,selectedKeys:this.state.selectedKeys,defaultExpandedKeys:this.state.expandedKeys,draggable:true,onDragEnter:this.onDragEnter,onDrop:this.onDrop},loop(this.state.menuLists))),this.state.visible?__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_2__AddOrEditRoleModel__[\"a\" /* default */],{title:this.state.isEditor?'编辑菜单':'新建菜单',visible:this.state.visible,isEditor:this.state.isEditor,onOk:this.saveAction,activeData:this.state.activeData,onCancel:function onCancel(){return _this2.setState({visible:false,isEditor:false});}}):null);}}]);return Menu;}(__WEBPACK_IMPORTED_MODULE_0_react___default.a.Component);/* harmony default export */ __webpack_exports__[\"default\"] = (Menu);\n\n/***/ }),\n\n/***/ 2255:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_react__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_react___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_react__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_antd__ = __webpack_require__(393);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__common_components_MainModal__ = __webpack_require__(1189);\nvar _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if(\"value\"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError(\"Cannot call a class as a function\");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");}return call&&(typeof call===\"object\"||typeof call===\"function\")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!==\"function\"&&superClass!==null){throw new TypeError(\"Super expression must either be null or a function, not \"+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}/**\r\n * Created by hutao on 2018/8/31.\r\n * 权限配置\r\n */var FormItem=__WEBPACK_IMPORTED_MODULE_1_antd__[\"k\" /* Form */].Item;var formItemLayout={labelCol:{span:4},wrapperCol:{span:19,style:{paddingLeft:'10px'}}};var AddOrEditRole=function(_Component){_inherits(AddOrEditRole,_Component);function AddOrEditRole(){var _ref;var _temp,_this,_ret;_classCallCheck(this,AddOrEditRole);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}return _ret=(_temp=(_this=_possibleConstructorReturn(this,(_ref=AddOrEditRole.__proto__||Object.getPrototypeOf(AddOrEditRole)).call.apply(_ref,[this].concat(args))),_this),_this.sureAction=function(){_this.props.form.validateFields(function(err,values){if(!err){_this.props.onOk(values);}});},_temp),_possibleConstructorReturn(_this,_ret);}_createClass(AddOrEditRole,[{key:'render',value:function render(){var getFieldDecorator=this.props.form.getFieldDecorator;var activeData=this.props.isEditor?this.props.activeData:undefined;// let isHasUrl = !activeData || activeData.subMenus.length===0;\nreturn __WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_2__common_components_MainModal__[\"a\" /* default */],{title:this.props.title,visible:true,onOk:this.sureAction,onCancel:this.props.onCancel,okText:'\\u786E\\u5B9A',cancelText:'\\u53D6\\u6D88'},__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(FormItem,Object.assign({},formItemLayout,{label:'\\u540D\\u79F0'}),getFieldDecorator('name',{rules:[{required:true,message:'请输入菜单名称'}],initialValue:activeData&&activeData.name})(__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_1_antd__[\"m\" /* Input */],{placeholder:'\\u8BF7\\u8F93\\u5165\\u83DC\\u5355\\u540D\\u79F0'}))));}}]);return AddOrEditRole;}(__WEBPACK_IMPORTED_MODULE_0_react__[\"Component\"]);var AddOrEditRoleModel=__WEBPACK_IMPORTED_MODULE_1_antd__[\"k\" /* Form */].create()(AddOrEditRole);/* harmony default export */ __webpack_exports__[\"a\"] = (AddOrEditRoleModel);\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// static/js/32.008e693d.chunk.js","import React from 'react';\r\nimport { Card, Tree, Icon, Modal, message } from 'antd';\r\nimport AddOrEditRoleModel from './AddOrEditRoleModel'\r\nimport { getAction, postAction } from '@/axios'\r\n\r\nconst TreeNode = Tree.TreeNode;\r\n\r\nconst iconStyle = {\r\n\tfontSize: '20px',\r\n\tcolor: '#aaa',\r\n\tmarginLeft: '10px'\r\n}\r\nconst iconActiveStyle = Object.assign({},iconStyle,{color:'rgb(24, 144, 255)'});\r\n\r\nclass Menu extends React.Component {\r\n\tstate = {\r\n\t\tmenuLists: [], //菜单列表\r\n\t\tselectedKeys: [], //选中节点\r\n\t\texpandedKeys: [], //展开节点\r\n\t\tvisible: false, //是否显示新增或修改模态框\r\n\t\tisEditor: false, //是否修改\r\n\t\tactiveData: undefined, //选中节点信息\r\n\t}\r\n\tcomponentWillMount() {\r\n\t\tthis.getMenuLists();\r\n\t}\r\n\t//获取菜单列表\r\n\tgetMenuLists = () => {\r\n\t\tgetAction('/bigdata/system/menu/list').then(res => {\r\n\t\t\tif (res.success) {\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tmenuLists: res.obj || []\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\t//选中节点修改\r\n\tonSelect = (selectedKeys, info) => {\r\n\t\tif(selectedKeys.length>0){\r\n\t\t\t// console.log(selectedKeys)\r\n\t\t\t// console.log(info)\r\n\t\t\tthis.setState({ selectedKeys, activeData: info.node.props.detail });\r\n\t\t} else {\r\n\t\t\tthis.setState({ selectedKeys, activeData: undefined });\r\n\t\t}\r\n\t}\r\n\t//拖拽开始\r\n\tonDragEnter = (info) => {\r\n\t\t// expandedKeys 需要受控时设置\r\n\t\tthis.setState({\r\n\t\t  expandedKeys: info.expandedKeys,\r\n\t\t});\r\n\t}\r\n\t//拖拽中\r\n\tonDrop = (info) => {\r\n\t\t// console.log(info.dragNode)\r\n\t\tlet dragNodeDetail = info.dragNode.props.detail;//拖动节点\r\n\t\tlet dropNodeDetail = info.node.props.detail;//放置节点\r\n\r\n\t\tconst dropKey = info.node.props.eventKey; //放置节点id\r\n\t\tconst dragKey = info.dragNode.props.eventKey; //拖动节点id\r\n\t\tconst dropPos = info.node.props.pos.split('-');\r\n\r\n\t\t//如果是父节点不能拖动到别人节点里面\r\n\t\t\r\n\t\tif(dragNodeDetail && dragNodeDetail.parentId<=0 && dragNodeDetail.subMenus.length>0 &&(dropPos.length>2 || !info.dropToGap)){\r\n\t\t\tmessage.warn('不能移动有子节点的节点！');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t//限制不能拖动到子节点上\r\n\t\tif(!info.dropToGap && dropPos.length>2){\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst dropPosition = info.dropPosition - Number(dropPos[dropPos.length - 1]);\r\n\t\t//参数\r\n\t\tlet targetSeq,targetParentId,id=dragKey;\r\n\t\tif(dropPos.length===2 && !info.dropToGap){\r\n\t\t\ttargetParentId = dropKey;\r\n\t\t\ttargetSeq = dropNodeDetail.seq+1;\r\n\t\t} else if(dropPos.length>2){\r\n\t\t\ttargetParentId = dropNodeDetail.parentId;\r\n\t\t\ttargetSeq = dropNodeDetail.seq+dropPosition;\r\n\t\t} else if(dropPos.length===2 && info.dropToGap){\r\n\t\t\ttargetParentId = -1;\r\n\t\t\ttargetSeq = dropNodeDetail.seq+dropPosition;\r\n\t\t}\r\n\t\t// console.log(dropPos.length,dropPosition,info.dropToGap,targetSeq,targetParentId,id)\r\n\t\tlet params = { id, targetParentId, targetSeq };\r\n\t\tpostAction('/bigdata/system/menu/move',params,0,1).then(res=>{\r\n            if(res.success){\r\n                message.success('移动成功！');\r\n\t\t\t\tthis.getMenuLists();\r\n            } else {\r\n                message.error(res.obj);\r\n            }\r\n        })\r\n\t}\r\n\r\n\t//删除菜单\r\n    deleteAction = () => {\r\n\t\tif(this.state.activeData){\r\n\t\t\tModal.confirm({\r\n\t\t\t\ttitle: `确定删除${this.state.activeData.name}菜单吗?`,\r\n\t\t\t\tonOk:()=> {\r\n\t\t\t\t\tlet data = {\r\n\t\t\t\t\t\tid: this.state.activeData.id\r\n\t\t\t\t\t}\r\n\t\t\t\t\tpostAction('/bigdata/system/menu/delete',data,0,1).then(res=>{\r\n\t\t\t\t\t\tif(res.success){\r\n\t\t\t\t\t\t\tmessage.success('删除成功！');\r\n\t\t\t\t\t\t\tthis.getMenuLists();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tmessage.error(res.obj);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t},\r\n\t\t\t\tonCancel() {},\r\n\t\t\t\tokText:'确定',\r\n\t\t\t\tcancelText:'取消',\r\n\t\t\t});\r\n\t\t}\r\n    }\r\n\t//删除和新增确定时保存角色信息\r\n\tsaveAction = (values) => {\r\n\t\tlet isEditor = this.state.isEditor;\r\n\t\t// let { name, seq, url } = values;\r\n\t\tlet { name } = values\r\n\t\t// let data = {name, seq, url, sourceCode: 'pc',iconUrl:'test',iconSelectedUrl:'test'};\r\n\t\tlet data={name}\r\n\t\tlet reqUrl = '/bigdata/system/menu/save'; //新增时的角色保存接口\r\n\t\t\r\n        if(isEditor){ //编辑角色时修改请求接口、添加角色id参数\r\n            reqUrl = '/bigdata/system/menu/update';\r\n\t\t\tdata.id = this.state.activeData.id\r\n\t\t\tdata.level=(this.state.activeData.id).toString().length\r\n\t\t} \r\n\t\t// else if(this.state.activeData && this.state.activeData.parentId<=0) {\r\n\t\t// \tdata.parentId = this.state.activeData.id;\r\n\t\t// }\r\n\t\t\r\n        postAction(reqUrl,data,0,1).then(res=>{\r\n            if(res.success){\r\n                message.success('保存成功！');\r\n                this.setState({visible:false,isEditor:false},()=>{\r\n\t\t\t\t\tthis.getMenuLists();\r\n\t\t\t\t});\r\n            } else {\r\n                message.error(res.obj);\r\n            }\r\n        })\r\n\t}\r\n\trender() {\r\n\t\t//递归菜单列表\r\n\t\tconst loop = data => data.map((item) => {\r\n\t\t\tif (item.subMenus && item.subMenus.length) {\r\n\t\t\t\treturn <TreeNode key={item.id} title={item.name} detail={item}>{loop(item.subMenus)}</TreeNode>;\r\n\t\t\t}\r\n\t\t\treturn <TreeNode key={item.id} title={item.name} detail={item}/>;\r\n\t\t});\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<Card\r\n\t\t\t\t\ttitle={<span style={{ color: '#1890FF', lineHeight: '34px' }}>菜单</span>}\r\n\t\t\t\t\textra={<div>\r\n\t\t\t\t\t\t{/* <Button icon=\"plus\" type=\"primary\" disabled={this.state.activeData&&(this.state.activeData.id).toString().length===3} style={{ marginRight: 20 }} onClick={()=>{\r\n\t\t\t\t\t\t\tthis.setState({visible:true,isEditor:false})\r\n\t\t\t\t\t\t}}>添加菜单</Button> */}\r\n\t\t\t\t\t\t<Icon type=\"form\" style={this.state.activeData?iconActiveStyle:iconStyle} onClick={()=>{\r\n\t\t\t\t\t\t\tif(this.state.activeData){\r\n\t\t\t\t\t\t\t\tthis.setState({visible:true,isEditor:true})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}} />\r\n\t\t\t\t\t\t{/* <Icon type=\"delete\" style={this.state.activeData?iconActiveStyle:iconStyle} onClick={this.deleteAction} /> */}\r\n\t\t\t\t\t</div>}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Tree\r\n\t\t\t\t\t\tonSelect={this.onSelect}\r\n\t\t\t\t\t\tselectedKeys={this.state.selectedKeys}\r\n\t\t\t\t\t\tdefaultExpandedKeys={this.state.expandedKeys}\r\n\t\t\t\t\t\tdraggable\r\n\t\t\t\t\t\tonDragEnter={this.onDragEnter}\r\n\t\t\t\t\t\tonDrop={this.onDrop}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{loop(this.state.menuLists)}\r\n\t\t\t\t\t</Tree>\r\n\t\t\t\t</Card>\r\n\t\t\t\t{this.state.visible?(\r\n                    <AddOrEditRoleModel\r\n                        title={this.state.isEditor?'编辑菜单':'新建菜单'}\r\n\t\t\t\t\t\tvisible={this.state.visible}\r\n\t\t\t\t\t\tisEditor={this.state.isEditor}\r\n                        onOk={this.saveAction}\r\n                        activeData={this.state.activeData}\r\n                        onCancel={()=>this.setState({visible:false,isEditor:false})}\r\n                    />\r\n                ):null}\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default Menu;\n\n\n// WEBPACK FOOTER //\n// ./src/pages/AccessManage/Menu/index.js","/**\r\n * Created by hutao on 2018/8/31.\r\n * 权限配置\r\n */\r\nimport React, { Component } from 'react';\r\nimport { Form, Input } from 'antd';\r\nimport MainModal from '@/common/components/MainModal';\r\n\r\nconst FormItem = Form.Item;\r\nconst formItemLayout = {\r\n    labelCol: { span: 4 },\r\n    wrapperCol: { span: 19, style:{paddingLeft:'10px'}},\r\n};\r\n\r\nclass AddOrEditRole extends Component {\r\n    sureAction = () => {\r\n        this.props.form.validateFields(\r\n            (err,values) => {\r\n                if (!err) {\r\n                    this.props.onOk(values);\r\n                }\r\n            },\r\n        );\r\n    }\r\n\trender () {\r\n        const { getFieldDecorator } = this.props.form;\r\n        let activeData = this.props.isEditor ? this.props.activeData: undefined;\r\n        // let isHasUrl = !activeData || activeData.subMenus.length===0;\r\n\t\treturn (\r\n\t\t\t<MainModal\r\n                title={this.props.title}\r\n                visible={true}\r\n                onOk={this.sureAction}\r\n                onCancel={this.props.onCancel}\r\n                okText=\"确定\"\r\n                cancelText=\"取消\"\r\n            >\r\n                <FormItem {...formItemLayout} label=\"名称\">\r\n                    {getFieldDecorator('name', {\r\n                        rules: [{\r\n                            required: true,\r\n                            message: '请输入菜单名称'\r\n                        }],\r\n                        initialValue: activeData&&activeData.name\r\n                    })(\r\n                        <Input placeholder=\"请输入菜单名称\" />\r\n                    )}\r\n                </FormItem>\r\n                {/* {isHasUrl?\r\n                    <FormItem {...formItemLayout} label=\"URL\">\r\n                        {getFieldDecorator('url', {\r\n                            rules: [{\r\n                                required: true,\r\n                                message: '请输入路由地址'\r\n                            }],\r\n                            initialValue: activeData&&activeData.url\r\n                        })(\r\n                            <Input placeholder=\"请输入路由地址\"/>\r\n                        )}\r\n                    </FormItem>:null\r\n                }\r\n                <FormItem {...formItemLayout} label=\"排序\">\r\n                    {getFieldDecorator('seq', {\r\n                        rules: [{\r\n                            required: true,\r\n                            message: '请输入排序'\r\n                        }],\r\n                        initialValue: activeData&&activeData.seq\r\n                    })(\r\n                        <Input.TextArea style={{resize:'none',height:60}} placeholder=\"请输入排序\"/>\r\n                    )}\r\n                </FormItem> */}\r\n            </MainModal>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nconst AddOrEditRoleModel = Form.create()(AddOrEditRole);\r\nexport default AddOrEditRoleModel;\n\n\n// WEBPACK FOOTER //\n// ./src/pages/AccessManage/Menu/AddOrEditRoleModel.js"],"sourceRoot":""}