{"version":3,"sources":["../static/js/3.1030f805.chunk.js","pages/login/index.js","axios.js"],"names":["webpackJsonp","1142","module","__webpack_exports__","__webpack_require__","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","defineProperty","__WEBPACK_IMPORTED_MODULE_0_react__","__WEBPACK_IMPORTED_MODULE_0_react___default","n","__WEBPACK_IMPORTED_MODULE_1_react_redux__","__WEBPACK_IMPORTED_MODULE_2__redux_actions_loginAction__","__WEBPACK_IMPORTED_MODULE_3__axios__","__WEBPACK_IMPORTED_MODULE_4__utils__","__WEBPACK_IMPORTED_MODULE_5_antd__","_createClass","defineProperties","target","props","i","length","descriptor","key","protoProps","staticProps","LoginPage","href","window","location","paramsIndex","indexOf","searchObj","params","substr","split","map","item","arr","userName","pwd","urltype","username","password","console","log","localStorage","setItem","this","handleLogin","message","warning","style","textAlign","paddingTop","size","React","Component","mapDispatchToProps","dispatch","data","postAction","curUrl","then","res","success","setLocal","JSON","stringify","obj","roleUrl","action","loginAction","error","connect","1147","contentTpyeArrs","options","baseURL","timeout","headers","post","ajax","axios","reqNumer","showloading","defaultContentType","interceptors","request","use","config","loadingAction","store","err","Promise","reject","response","useResponse","errorCode","clearLocal","status","warn","getAction","url","isShowloading","get","contentTpyeIndex","_contentTpye","_data","Qs"],"mappings":"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","file":"static/js/3.1030f805.chunk.js","sourcesContent":["webpackJsonp([3],{\n\n/***/ 1142:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_react__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_react___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_react__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_react_redux__ = __webpack_require__(100);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__redux_actions_loginAction__ = __webpack_require__(213);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__axios__ = __webpack_require__(1147);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__utils__ = __webpack_require__(132);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_antd__ = __webpack_require__(393);\nvar _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if(\"value\"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError(\"Cannot call a class as a function\");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");}return call&&(typeof call===\"object\"||typeof call===\"function\")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!==\"function\"&&superClass!==null){throw new TypeError(\"Super expression must either be null or a function, not \"+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}// import store from 'userRedux/store';\n// import { loadingAction } from 'userRedux/actions/loadingAction';\nvar LoginPage=function(_React$Component){_inherits(LoginPage,_React$Component);function LoginPage(){_classCallCheck(this,LoginPage);return _possibleConstructorReturn(this,(LoginPage.__proto__||Object.getPrototypeOf(LoginPage)).apply(this,arguments));}_createClass(LoginPage,[{key:'componentDidMount',value:function componentDidMount(){// 心理健康会话失效跳转到登录页去掉loading\n// store.dispatch(loadingAction(false));\nvar href=window.location.href;var paramsIndex='';if(href.indexOf('?')>-1){var searchObj={};paramsIndex=href.indexOf('?')+1;var params=href.substr(paramsIndex).split('&');if(params&&params.length>0){params.map(function(item){var arr=item.split('=');searchObj[arr[0]]=arr[1];});}if(searchObj.userName&&searchObj.pwd&&searchObj.urltype){var username=searchObj.userName;var password=searchObj.pwd;var urltype=searchObj.urltype;console.log(username,password,urltype);// 此处存储其实无用\nwindow.localStorage.setItem(\"urltype\",urltype);this.props.handleLogin({username:username,password:password});}else{__WEBPACK_IMPORTED_MODULE_5_antd__[\"J\" /* message */].warning(\"URL配置错误，请联系开发人员重新配置！\",5);}}else{__WEBPACK_IMPORTED_MODULE_5_antd__[\"J\" /* message */].warning(\"URL配置错误，请联系开发人员重新配置！\",5);}}},{key:'render',value:function render(){return __WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('div',{style:{textAlign:\"center\",paddingTop:\"30vh\"}},__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_5_antd__[\"z\" /* Spin */],{size:'large'}));}}]);return LoginPage;}(__WEBPACK_IMPORTED_MODULE_0_react___default.a.Component);var mapDispatchToProps=function mapDispatchToProps(dispatch){return{handleLogin:function handleLogin(data){var curUrl='/bigdata/user/login';var roleUrl='/bigdata/system/menu/getLoginNameRole';Object(__WEBPACK_IMPORTED_MODULE_3__axios__[\"b\" /* postAction */])(curUrl,data).then(function(res){if(res.success){Object(__WEBPACK_IMPORTED_MODULE_4__utils__[\"i\" /* setLocal */])(\"userInfo\",JSON.stringify(res.obj));Object(__WEBPACK_IMPORTED_MODULE_4__utils__[\"i\" /* setLocal */])(\"loginStatus\",true);Object(__WEBPACK_IMPORTED_MODULE_3__axios__[\"b\" /* postAction */])(roleUrl,{userName:res.obj.username},0,1).then(function(res){return Object(__WEBPACK_IMPORTED_MODULE_4__utils__[\"i\" /* setLocal */])(\"isAdmin\",JSON.stringify(res.obj));});var action=Object(__WEBPACK_IMPORTED_MODULE_2__redux_actions_loginAction__[\"a\" /* loginAction */])(true);dispatch(action);}else{__WEBPACK_IMPORTED_MODULE_5_antd__[\"J\" /* message */].error(res.obj);}});}};};/* harmony default export */ __webpack_exports__[\"default\"] = (Object(__WEBPACK_IMPORTED_MODULE_1_react_redux__[\"connect\"])(null,mapDispatchToProps)(LoginPage));\n\n/***/ }),\n\n/***/ 1147:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return getAction; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return postAction; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_axios__ = __webpack_require__(398);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_axios___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_axios__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_qs__ = __webpack_require__(399);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_qs___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_qs__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__redux_store__ = __webpack_require__(104);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_antd__ = __webpack_require__(393);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__redux_actions_loadingAction__ = __webpack_require__(215);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__redux_actions_loginAction__ = __webpack_require__(213);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__utils__ = __webpack_require__(132);\n//请求 头contentTpye类型\nvar contentTpyeArrs=[\"application/json\",\"application/x-www-form-urlencoded;charset=UTF-8\"];//基本设置\nvar options={baseURL:\"\",timeout:20000,headers:{post:{'Content-Type':contentTpyeArrs[0]}}// 'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8'\n};var ajax=__WEBPACK_IMPORTED_MODULE_0_axios___default.a.create(options);var reqNumer=0;// 发起请求的数量, 只要大于0,显示loading动画(前提是num = 0);请勿改动;\nvar showloading=true;// 定义全局变量用于控制loading局部的使用;请勿改动;\nvar defaultContentType=contentTpyeArrs[0];// 默认的请求头信息,根据实际情况可做更改\najax.interceptors.request.use(function(config){//在请求发出之前进行一些操作\n//在请求发出之前进行一些操作, 比如加载动画\nif(showloading){reqNumer++;};if(reqNumer>0){// 显示加载动画\nvar action=Object(__WEBPACK_IMPORTED_MODULE_4__redux_actions_loadingAction__[\"a\" /* loadingAction */])(true);__WEBPACK_IMPORTED_MODULE_2__redux_store__[\"a\" /* default */].dispatch(action);}return config;},function(err){//Do something with request error\nreturn Promise.reject(err);});ajax.interceptors.response.use(function(response){// 接受请求后reqNumer--，判断请求所有请求是否完成\nif(showloading){reqNumer--;};if(reqNumer<=0){reqNumer=0;// 隐藏加载动画\nvar action=Object(__WEBPACK_IMPORTED_MODULE_4__redux_actions_loadingAction__[\"a\" /* loadingAction */])(false);__WEBPACK_IMPORTED_MODULE_2__redux_store__[\"a\" /* default */].dispatch(action);}else{var _action=Object(__WEBPACK_IMPORTED_MODULE_4__redux_actions_loadingAction__[\"a\" /* loadingAction */])(true);__WEBPACK_IMPORTED_MODULE_2__redux_store__[\"a\" /* default */].dispatch(_action);}//统一处理返回数据\nvar useResponse=response.data;if(useResponse.success){return{\"success\":true,\"obj\":useResponse[\"obj\"]};}else{if(useResponse.errorCode===\"403\"){Object(__WEBPACK_IMPORTED_MODULE_6__utils__[\"c\" /* clearLocal */])();// 单点登录地址  //单点登录第六处修改\n// window.location.href = 'http://10.64.192.20:6050/bigdata/user/singleLogout';\nvar _action2=Object(__WEBPACK_IMPORTED_MODULE_5__redux_actions_loginAction__[\"a\" /* loginAction */])(false);__WEBPACK_IMPORTED_MODULE_2__redux_store__[\"a\" /* default */].dispatch(_action2);return{\"success\":false};// step1：退出登录(后台);\n// step2：前端(重写本地存储);\n// step3：页面(重定向至登录注册页面)\n}else{return{\"success\":false,\"obj\":useResponse[\"msg\"]};}}},function(error){// 对响应错误做点什么\nif(error&&error.response){switch(error.response.status){case 400:__WEBPACK_IMPORTED_MODULE_3_antd__[\"J\" /* message */].warn('请求错误');break;case 401:__WEBPACK_IMPORTED_MODULE_3_antd__[\"J\" /* message */].warn('未授权，请重新登录');break;case 403:__WEBPACK_IMPORTED_MODULE_3_antd__[\"J\" /* message */].warn('拒绝访问');break;case 404:__WEBPACK_IMPORTED_MODULE_3_antd__[\"J\" /* message */].warn('请求出错');break;case 408:__WEBPACK_IMPORTED_MODULE_3_antd__[\"J\" /* message */].warn('请求超时');break;case 500:__WEBPACK_IMPORTED_MODULE_3_antd__[\"J\" /* message */].warn('服务器错误');break;case 501:__WEBPACK_IMPORTED_MODULE_3_antd__[\"J\" /* message */].warn('服务未实现');break;case 502:__WEBPACK_IMPORTED_MODULE_3_antd__[\"J\" /* message */].warn('网络错误');break;case 503:__WEBPACK_IMPORTED_MODULE_3_antd__[\"J\" /* message */].warn('服务不可用');break;case 504:__WEBPACK_IMPORTED_MODULE_3_antd__[\"J\" /* message */].warn('网络超时(504)');break;case 505:__WEBPACK_IMPORTED_MODULE_3_antd__[\"J\" /* message */].warn('HTTP版本不受支持');break;default:__WEBPACK_IMPORTED_MODULE_3_antd__[\"J\" /* message */].warn('\\u8FDE\\u63A5\\u51FA\\u9519!');}reqNumer--;if(reqNumer<=0){var action=Object(__WEBPACK_IMPORTED_MODULE_4__redux_actions_loadingAction__[\"a\" /* loadingAction */])(false);__WEBPACK_IMPORTED_MODULE_2__redux_store__[\"a\" /* default */].dispatch(action);}return Promise.reject(error);}else{__WEBPACK_IMPORTED_MODULE_3_antd__[\"J\" /* message */].warn(\"请求超时\");reqNumer--;if(reqNumer<=0){var _action3=Object(__WEBPACK_IMPORTED_MODULE_4__redux_actions_loadingAction__[\"a\" /* loadingAction */])(false);__WEBPACK_IMPORTED_MODULE_2__redux_store__[\"a\" /* default */].dispatch(_action3);}return Promise.reject(error);}});var getAction=function getAction(url){var data=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var isShowloading=arguments[2];// 判断当前请求是否显示loading, 默认显示\nif(isShowloading&&isShowloading===1){showloading=false;// 不显示loading\n}else{showloading=true;// 显示\n}return ajax.get(url,{params:data});};var postAction=function postAction(url){var data=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var isShowloading=arguments[2];var contentTpyeIndex=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;// 判断当前请求是否显示loading, 默认显示,isShowloading===1为不显示，contentTpyeIndex=0为contentTpyeArrs索引，默认为0\nif(isShowloading&&isShowloading===1){showloading=false;// 不显示loading\n}else{showloading=true;// 显示\n}// 判断当前请求类型，确定向后端传递数据的方式,前后端沟通后按约定改动\nvar _contentTpye=contentTpyeArrs[contentTpyeIndex]||defaultContentType;var _data=void 0;if(_contentTpye===contentTpyeArrs[1]){_data=__WEBPACK_IMPORTED_MODULE_1_qs___default.a.stringify(data);}else if(_contentTpye===contentTpyeArrs[0]){_data=JSON.stringify(data);}return ajax.post(url,_data,{headers:{'Content-Type':_contentTpye}});};\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// static/js/3.1030f805.chunk.js","import React from 'react';\r\nimport { connect} from 'react-redux';\r\n// import store from 'userRedux/store';\r\nimport { loginAction } from './../../redux/actions/loginAction';\r\n// import { loadingAction } from 'userRedux/actions/loadingAction';\r\nimport { postAction } from './../../axios';\r\nimport { setLocal } from './../../utils';\r\nimport {message,Spin } from 'antd';\r\n\r\nclass LoginPage extends React.Component{\r\n\tcomponentDidMount(){\r\n        // 心理健康会话失效跳转到登录页去掉loading\r\n        // store.dispatch(loadingAction(false));\r\n\r\n        let href= window.location.href;\r\n        let paramsIndex = '';\r\n        if (href.indexOf('?') > -1) {\r\n            let searchObj = {};\r\n            paramsIndex = href.indexOf('?') + 1;\r\n            let params = href.substr(paramsIndex).split('&');\r\n            if (params && params.length > 0) {\r\n                params.map(\r\n                    (item) => {\r\n                        let arr = item.split('=');\r\n                        searchObj[arr[0]] = arr[1]\r\n                    }\r\n                )\r\n            }\r\n            if (searchObj.userName && searchObj.pwd && searchObj.urltype) {\r\n                let username = searchObj.userName;\r\n                let password = searchObj.pwd;\r\n                let urltype = searchObj.urltype;\r\n                console.log(username,password,urltype)\r\n                // 此处存储其实无用\r\n                window.localStorage.setItem(\"urltype\", urltype);\r\n                this.props.handleLogin({username, password});\r\n            } else {\r\n                message.warning(\"URL配置错误，请联系开发人员重新配置！\",5)\r\n            }\r\n        } else {\r\n            message.warning(\"URL配置错误，请联系开发人员重新配置！\",5)\r\n        }\r\n\t}\r\n\r\n    render () {\r\n        return (\r\n            <div style={{textAlign:\"center\", paddingTop:\"30vh\"}}>\r\n              <Spin size=\"large\" />\r\n           </div>\r\n        )\r\n    }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n    return {\r\n        handleLogin (data) {\r\n            const curUrl = `/bigdata/user/login`;\r\n            const roleUrl = `/bigdata/system/menu/getLoginNameRole`\r\n            postAction(curUrl,data).then (function (res) {\r\n                if (res.success) {\r\n\t\t\t\t\tsetLocal(\"userInfo\", JSON.stringify(res.obj));\r\n\t\t\t\t\tsetLocal(\"loginStatus\", true);\r\n\t\t\t\t\tpostAction(roleUrl,{userName:res.obj.username},0,1).then((res) => (\r\n\t\t\t\t\t\tsetLocal(\"isAdmin\", JSON.stringify(res.obj))\r\n\t\t\t\t\t))\r\n\t\t\t\t\tconst action  = loginAction(true);\r\n\t\t\t\t\tdispatch(action);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmessage.error(res.obj);\r\n\t\t\t\t}\r\n            })\r\n        }\r\n    }\r\n}\r\n\r\nexport default connect(null, mapDispatchToProps)(LoginPage)\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/login/index.js","import axios from 'axios';\r\nimport Qs from \"qs\";\r\nimport store from './redux/store';\r\nimport { message } from 'antd';\r\nimport { loadingAction } from './redux/actions/loadingAction';\r\nimport { loginAction } from './redux/actions/loginAction'\r\nimport { clearLocal } from './utils';\r\n\r\n//请求 头contentTpye类型\r\nconst contentTpyeArrs = [\r\n    \"application/json\",\r\n\t\"application/x-www-form-urlencoded;charset=UTF-8\"\r\n]\r\n\r\n//基本设置\r\nlet options = {\r\n    baseURL: \"\",\r\n    timeout: 20000,\r\n    headers: {\r\n        post: {\r\n            'Content-Type': contentTpyeArrs[0]\r\n        }\r\n    }\r\n}\r\n\r\n// 'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8'\r\n            \r\nconst ajax = axios.create(options);\r\n\r\nlet reqNumer = 0; // 发起请求的数量, 只要大于0,显示loading动画(前提是num = 0);请勿改动;\r\nlet showloading = true; // 定义全局变量用于控制loading局部的使用;请勿改动;\r\nlet defaultContentType = contentTpyeArrs[0]; // 默认的请求头信息,根据实际情况可做更改\r\n\r\najax.interceptors.request.use((config) => {  //在请求发出之前进行一些操作\r\n    //在请求发出之前进行一些操作, 比如加载动画\r\n\tif (showloading) {\r\n        reqNumer++;\r\n    };\r\n    if (reqNumer > 0) {\r\n        // 显示加载动画\r\n        const action = loadingAction(true);\r\n        store.dispatch(action);\r\n    }\r\n    \r\n    return config;\r\n},(err) => {\r\n    //Do something with request error\r\n    return Promise.reject(err);\r\n})\r\n\r\najax.interceptors.response.use((response) => {  // 接受请求后reqNumer--，判断请求所有请求是否完成\r\n    if (showloading) {\r\n        reqNumer--;\r\n    };\r\n    if (reqNumer <= 0) {\r\n        reqNumer = 0;\r\n        // 隐藏加载动画\r\n        const action = loadingAction(false);\r\n        store.dispatch(action);\r\n    } else {\r\n        const action = loadingAction(true);\r\n        store.dispatch(action);\r\n    }\r\n    //统一处理返回数据\r\n    const useResponse = response.data;\r\n    if (useResponse.success) {\r\n        return { \"success\": true, \"obj\": useResponse[\"obj\"] };\r\n    } else {\r\n        if (useResponse.errorCode === \"403\") {\r\n            clearLocal();\r\n            // 单点登录地址  //单点登录第六处修改\r\n            // window.location.href = 'http://10.64.192.20:6050/bigdata/user/singleLogout';\r\n            const action = loginAction(false);\r\n            store.dispatch(action);\r\n            return { \"success\": false };\r\n            // step1：退出登录(后台);\r\n            // step2：前端(重写本地存储);\r\n            // step3：页面(重定向至登录注册页面)\r\n        } else {\r\n            return { \"success\": false, \"obj\": useResponse[\"msg\"] };\r\n        }\r\n    }\r\n}, function (error) {\r\n    // 对响应错误做点什么\r\n    if (error && error.response) {\r\n        switch (error.response.status) {\r\n            case 400: message.warn('请求错误') ; break;\r\n            case 401: message.warn('未授权，请重新登录'); break;\r\n            case 403: message.warn('拒绝访问'); break;\r\n            case 404: message.warn('请求出错'); break;\r\n            case 408: message.warn('请求超时'); break;\r\n            case 500: message.warn('服务器错误'); break;\r\n            case 501: message.warn('服务未实现'); break;\r\n            case 502: message.warn('网络错误'); break;\r\n            case 503: message.warn('服务不可用'); break;\r\n            case 504: message.warn('网络超时(504)'); break;\r\n            case 505: message.warn('HTTP版本不受支持'); break;\r\n            default: message.warn(`连接出错!`);\r\n        }\r\n        reqNumer--;\r\n        if (reqNumer <= 0) {\r\n            const action = loadingAction(false);\r\n            store.dispatch(action);\r\n        }\r\n        return Promise.reject(error);\r\n\r\n    } else {\r\n        message.warn(\"请求超时\");\r\n        reqNumer--;\r\n        if (reqNumer <= 0) {\r\n            const action = loadingAction(false);\r\n            store.dispatch(action);\r\n        }\r\n        return Promise.reject(error);\r\n    }\r\n})\r\n\r\nconst getAction = function (url, data={}, isShowloading) {\r\n\r\n    // 判断当前请求是否显示loading, 默认显示\r\n\tif (isShowloading && isShowloading === 1){ \r\n\t\tshowloading = false // 不显示loading\r\n\t} else {\r\n\t\tshowloading = true // 显示\r\n\t}\r\n\r\n    return ajax.get(url, {\r\n        params: data\r\n    });\r\n}\r\n\r\nconst postAction = function (url, data={}, isShowloading, contentTpyeIndex=0) {\r\n    // 判断当前请求是否显示loading, 默认显示,isShowloading===1为不显示，contentTpyeIndex=0为contentTpyeArrs索引，默认为0\r\n\tif (isShowloading && isShowloading === 1){ \r\n\t\tshowloading = false // 不显示loading\r\n\t} else {\r\n\t\tshowloading = true // 显示\r\n\t}\r\n\t\r\n\t// 判断当前请求类型，确定向后端传递数据的方式,前后端沟通后按约定改动\r\n    let _contentTpye = contentTpyeArrs[contentTpyeIndex] || defaultContentType;\r\n    \r\n    let _data;\r\n\t\r\n\tif (_contentTpye === contentTpyeArrs[1]) {\r\n        _data = Qs.stringify(data)\r\n\t} else if (_contentTpye === contentTpyeArrs[0]){\r\n        _data = JSON.stringify(data)\r\n\t}\r\n    return ajax.post(url, _data, {\r\n        headers: {\r\n            'Content-Type': _contentTpye\r\n        }\r\n    });\r\n}\r\n\r\nexport {\r\n    getAction,\r\n    postAction\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/axios.js"],"sourceRoot":""}